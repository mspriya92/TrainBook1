name: Re-usable-workflow
on: 
  workflow_dispatch:
jobs:
  fetch-and-output-info:
     runs-on: ubuntu-latest
 
     steps:
       - name: Checkout repository
         uses: actions/checkout@v3
 
       - name: Read Component.json
         id: read-json
         run: |
           components=$(cat component.json)
           echo "::set-output name=components::$components"
 
       - name: Fetch commit 
         id: fetch_commit_value
         run: |
          components=$(echo "${{ steps.read-json.outputs.components }}")

          # Loop through each component in the JSON array
          for component in $(echo "$components" | jq -r '.[]'); do
            Phase=$(echo "$component" | jq -r '.Phase')
            Branch=$(echo "$component" | jq -r '.Branch')
            code=$(echo "$component" | jq -r '.code')

            # Store values in environment variables
            echo "::set-env name=COMPONENT_PHASE::$Phase"
            echo "::set-env name=COMPONENT_BRANCH::$Branch"
            echo "::set-env name=COMPONENT_CODE::$code"
          done
