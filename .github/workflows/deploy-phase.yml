name: Deploy Phase
on:
  workflow_call:
    outputs:
      log1:
        description: "First output from deploy component"
        value: ${{ jobs.call_deploy_workflow.outputs.error1 }}
      log2:
        description: "Second output from deploy component"
        value: ${{ jobs.call_deploy_workflow.outputs.error2 }}
      log3:
        description: "Output from job 3"
        value: ${{ jobs.call_deploy_workflow.outputs.error3 }}
      log4:
        description: "Output from job 4"
        value: ${{ jobs.call_deploy_workflow.outputs.error4 }}
      log5:
        description: "Error message from deploy component"
        value: ${{ jobs.call_deploy_workflow.outputs.error_message }}

jobs:
  call_deploy_workflow:
    #runs-on: ubuntu-latest
    uses: ./.github/workflows/deploy-component.yml

  handle_errors:
    runs-on: ubuntu-latest
    needs: call_deploy_workflow
    steps:
      - name: error handling 
        #id: error-handle
        #uses: ./.github/action/deploy-component.yml
        run: |
          echo "First Word from deploy component: ${{ needs.call_deploy_workflow.outputs.firstword }}"
          echo "Second Word from deploy component: ${{ needs.call_deploy_workflow.outputs.secondword }}"
          echo "Message from job3: ${{ needs.call_deploy_workflow.outputs.job3_message }}"
          echo "Message from job4: ${{ needs.call_deploy_workflow.outputs.job4_message }}"
          echo "Error Message from deploy component: ${{ needs.call_deploy_workflow.outputs.error_message }}"
          if [[ "${{ needs.call_deploy_workflow.outputs.error_message }}" == "Something went wrong in component!" ]]; then
            echo "Critical error in deployment, failing phase deployment."
            exit 1
          fi
